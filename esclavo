#include <Servo.h>


Servo servo;
Servo servo2;

// Definición de la secuencia de movimientos para la bandera roja
int secuencia[] = {45, 135, 45, 135, 45, 135, 45, 135, 0};
// Definición de la secuencia de movimientos para la bandera verde
int secuencia2[] = {0, 90, 0};


  const long interval = 2000;  // interval at which to blink (milliseconds)
  unsigned long previousMillis = 0;
  
 

void setup() {
//Se definen los pines que manejan la señal de los servo;
  servo.attach(2); 
  servo2.attach(3);
//Pines de entradas desde el arduino maestro
  pinMode(13, INPUT);
  pinMode(12, INPUT);
  pinMode(11, INPUT);
  pinMode(10, INPUT);
  pinMode(9, INPUT);
  pinMode(8, INPUT);

}

void loop() { //Aquí comienzan las transiciones de estado
servo.write(0);
servo2.write(0);
        if (digitalRead(9) == HIGH) 
        {
        digitalWrite(7,HIGH);
        delay(2000);
        digitalWrite(7,LOW);
        for (int i = 0; i <= 8; i++) {
        int angulo = secuencia[i];
        servo.write(angulo);
   		delay(500); // Espera medio segundo antes de pasar al siguiente movimiento
        }
        }

        else if (digitalRead(10)==HIGH)
        {
        digitalWrite (6,HIGH);
        delay(2000);
        digitalWrite(6,LOW);
        for (int i = 0; i <= 8; i++) {
        int angulo = secuencia[i];
        servo.write(angulo);
        delay(1000); // Espera 1 segundo antes de pasar al siguiente movimiento
        }
        }
        else if (digitalRead(11)==HIGH)
        {
        digitalWrite(5,HIGH);
        delay(2000);
        digitalWrite(5,LOW);
        for (int i = 0; i <= 8; i++) {
        int angulo = secuencia[i];
        servo.write(angulo);
        delay(1000); // Espera 1 segundo antes de pasar al siguiente movimiento
        }
        }
        else if (digitalRead(12)==HIGH)
        {
        digitalWrite(4,HIGH);
        delay(2000);
        digitalWrite(4,LOW);
        for (int i = 0; i <= 8; i++) {
        int angulo = secuencia[i];
        servo.write(angulo);
        delay(1000); // Espera 1 segundo antes de pasar al siguiente movimiento
        }
        }
        else if (digitalRead(13)==HIGH)
        {
        for (int u = 0; u <= 2; u++) {
        int angulo = secuencia2[u];
        servo2.write(angulo);
        delay(500); // Espera medio segundo antes de pasar al siguiente movimiento
        }
        }
  unsigned long currentMillis = millis();
if (currentMillis - previousMillis >=
interval) {
previousMillis = currentMillis;
}
}
